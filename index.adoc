= Go Study Notes
Author whoyiming <whoyiming@outlook.com>
:doctype: book
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectnums:
:sectid:
:icons: font

[preface]
== 引言

此文档是关于学习Go语言所做的笔记，方便后续复习，温故而知新。

== Go 语言简介

=== 什么是Go

Go是由 Google 主导开发的静态类型、编译型编程语言，于 2009 年开源，设计目标是解决大型软件开发中的效率、复杂度与并发难题，核心哲学是 “简洁、高效、实用”。

** 极简设计：语法精简，移除冗余特性（如继承、复杂泛型早期缺失），用 “组合” 替代 “继承”，代码可读性高，学习成本低（例如强制统一格式的go fmt工具，避免风格争议）。

** 高性能：编译为机器码，执行效率接近 C 语言，远超解释型语言（如 Python）；启动速度极快（毫秒级），内存占用低，适合高性能服务场景。

** 原生并发：通过goroutine（轻量级线程，开销仅为操作系统线程的 1/100~1/10，单机可轻松创建百万级并发）和channel（通信管道）简化并发编程，从语言层面解决多核时代的并发难题。

** 平衡开发效率与可靠性：静态类型确保编译时错误检查（比动态语言更可靠），同时内置垃圾回收（GC）避免手动内存管理（比 C/C++ 更高效），开发效率接近动态语言。

=== Go 与 Java Python 的对比及其生态与场景

|===
| 维度       | Go                             | Java                             | Python                             
| 执行方式   | 编译型（直接生成机器码）| 编译型（字节码，依赖 JVM）| 解释型（依赖 Python 解释器）
| 启动速度   | 极快（毫秒级，单一二进制文件）| 较慢（JVM 预热耗时，秒级）| 中等（解释器启动快，但执行慢）
| 运行时性能 | 接近 C（CPU 密集型表现优异）| 优秀（JIT 优化后接近原生）| 较差（解释执行，比前两者慢 10-100 倍）
| 内存占用   | 低（无 JVM overhead）| 中高（JVM 本身占用内存）| 中（解释器 + 动态类型开销）
|===

|===
| 领域           | Go 擅长                                  | Java 擅长                                  | Python 擅长                                  
| 云原生 / 分布式 | Docker、K8s、Etcd、微服务                 | 分布式框架（Dubbo、Spring Cloud）| 边缘脚本、监控工具                           
| 企业级应用     | 轻量微服务（如字节跳动推荐系统）| 大型业务系统（银行、电商核心系统）| 内部工具、数据分析后台                       
| 移动开发       | 跨平台工具（如 Flutter 引擎）| 安卓应用（官方开发语言）| 无（仅辅助脚本）
| 数据科学 / AI  | 高性能计算引擎（如 TensorFlow 部分模块）| 机器学习框架（如 H2O）| 数据分析（Pandas）、AI（PyTorch/TensorFlow） 
| 工具开发       | 命令行工具（Terraform、Prometheus）| 企业级工具（Jenkins）| 自动化脚本、爬虫                             
|===

=== Go的前世今生

学习一门语言，要了解其前世今生，历史与现状，才能对一门语言有更加深入的理解。了解Go 语言是怎么诞生的，就能清晰知道Go 是为了解决什么问题，了解现状，就能知道语言发展经历到了什么阶段，能解决多大的问题。

Go 语言的创始人有三位，分别是图灵奖获得者、C 语法联合发明人、Unix 之父肯·汤普森（Ken Thompson），Plan 9 操作系统领导者、UTF-8 编码的最初设计者罗伯·派克（Rob Pike），以及 Java 的 HotSpot 虚拟机和 Chrome 浏览器的 JavaScript V8 引擎的设计者之一罗伯特·格瑞史莫（Robert Griesemer）。

image::images/93e91ef659a99c1e37d1fd54a8655375.webp[title="Go语言之父们（从左到右分别是Robert Griesemer、Rob Pike和Ken Thompson）"]

Go 诞生于一次研讨，三位大牛交换了关于设计一门新编程语言的想法。

当时，他们在谷歌内部使用的是 +++ C++ +++ 语言来构建各种系统，但 +++ C++ +++ 有着巨大的复杂性、编译构建慢、编写服务端不容易且对并发支持不足。三位大牛都觉得不方便，随即一拍即合，有了设计新语言的想法。新语言需要有简洁、高效、让人使用方便，且满足未来硬件发展趋势和大规模网络服务的程序。由此，Go语言的雏形便出现。随着三人想法的落地，再到社区运营更多人的参与，现在Go语言已经是一门在云原生、网络、企业级应用等方面有着足够竞争力的语言。同时，Go语言也在不断加入新特性，保证语言的活力。

== Go 环境配置

以下是windows环境安装Go语言。

访问 https://golang.google.cn/ （有可能打不开） 或者 https://go.dev/dl/ 。找到windows的包，下载安装版，在弹出的对话框中选择合适的目录进行安装。

image::images/2025-11-22-110052.png[]

如装在 C:\Go\Go1.25.4 ，其结构是

image:images/2025-11-22-110735.png[]

在终端中输入 go version 得到 go version go1.25.4 windows/amd64 ，便安装成功。

image:images/2025-11-23-102458.png[]

[CAUTION]
安装成功后，要重新启动终端，系统中设置的环境变量才会生效

== helloworld

创建一个文件夹 gocodes 写的代码。进入 gocodes，创建一个fisrtgo的文件夹，用于写第一个Go语言代码，进入firstgo，再创建一个hello.go的文件，用记事本打开，输入

[source, Go]
```
package main

import "fmt"

func main() {
   fmt.Println("Hello, World!")
}
```

在终端上运行go run hello.go 得到 ** Hello, World!**

image:images/2025-11-23-101522.png[]

=== 基本程序结构

* package main   // 包，表面代码所在的模块（包），通常使用单个的小写字母命名。main包在Go中是一个特殊的包，整个 Go 程序中仅允许存在一个名为 main 的包。
* import "fmt"  // import引入fmt包，fmt 包实现了格式化 IO（输入/输出）的函数。
* func main()  // 程序开始执行的函数，函数内容用大括号包裹。当运行一个可执行的Go程序的时候，所有代码从此此处开始。
* fmt.Println("Hello, World!") // 使用fmt.Println方法，进行输出。

=== 与java的对比

|===
| 对比维度 | Go 语言（基于示例代码） | Java 语言（对应 Hello World 实现）

| 完整代码示例
| [source,go]
----
package main

import "fmt"

func main() {
    fmt.Println("hello, world")
}
----
| [source,java]
----
// 若声明包，需与目录结构一致（示例省略包声明）
public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("hello, world");
    }
}
----

| 包声明规则
| 入口程序必须声明为 `package main`（固定要求），非入口包可自定义包名
| 包声明可选（无包声明则为默认包），**公共类名必须与文件名一致**（大小写敏感）

| 导入语句
| 直接导入依赖包路径（如 `import "fmt"`），支持批量导入（用 `()` 包裹多个包）
| 导入格式为 `import 包路径`（如 `import java.util.List`），`java.lang` 包（含 `System`）默认导入，无需显式声明

| 程序入口
| 入口是 `main` 包下的 `main()` 函数：
- 无参数、无返回值
- 无需修饰符（默认可见性）
| 入口是 **公共类** 下的 `main` 静态方法：
- 必须是 `public static void main(String[] args)`
- 需通过类名关联（运行时指定类名）

| 输出方式
| 使用标准库 `fmt` 包的 `Println()` 函数（格式化输出常用）
| 使用 `System.out.println()`（`System` 是 `java.lang` 包的类，`out` 是静态成员，`println()` 是实例方法）

| 编译与运行机制
| 1. 编译：`go build` 生成 **原生二进制文件**（跨平台需指定 `GOOS`/`GOARCH`）
2. 运行：直接执行二进制文件，或 `go run` 一键编译运行
| 1. 编译：`javac` 生成 `.class` 字节码文件
2. 运行：`java 类名` 由 JVM 解释字节码（跨平台依赖 JVM）

| 语法简洁性
| 无类、接口等面向对象语法，样板代码极少（仅3行核心逻辑）
| 必须用类包裹代码，需显式声明访问修饰符（`public`）和静态修饰符（`static`），样板代码较多

|===

- Go 以 **简洁、高效、原生编译** 为核心，弱化面向对象，更注重工程实用性和并发性能；
- Java 以 **强类型、面向对象、跨平台** 为核心，语法严谨，生态成熟，适合需要复杂架构设计的大型应用；
- 从 Hello World 就能看出：Go 追求“少即是多”，Java 追求“规范与扩展性”。

=== 加点复杂度

如果想要打印由终端输入的参数该怎么做呢？

在fisrtgo文件下创建一个printenv.go的文件

[source, Go]
```
package main

import (
	"fmt"
	"os"
)

func main() {
	if len(os.Args) > 1 {
		fmt.Println("Hello", os.Args[1])
	}
}
```

在终端下输入  go run .\printenv.go master

image:images/2025-11-23-111917.png[]

[TIP]
windows会默认隐藏拓展名，因此我们需要设置显示拓展名，如图所示进行设置

image:images/2025-11-22-113000.png[]

== Go 的基础语法

=== 数据类型

|===
| 类型分类       | 具体类型            | 说明

| 数值型         
| int（随系统位数）、int8/16/32/64   
| 有符号整数（int 在 32 位系统是 32 位，64 位系统是 64 位） 

|                
| uint（无符号）、uint8（byte）      
| 无符号整数（byte 是 uint8 的别名） 

|                
| float32、float64                  
| 浮点数（默认用 float64，精度更高），float32的精度约6-7位，float64的精度约 15-17 位

|                
| complex64、complex128             
| 复数（实部+虚部，如 `3+4i`）         

| 布尔型         
| bool                              
| 取值 true/false（不能用 0/1 替代）   

| 字符串         
| string                            
| 不可变字符序列（UTF-8 编码）         

| 字符型         
| rune                              
| Unicode 码点（int32 的别名，用于处理中文等多字节字符） 

|===

[source, Go]
----
package main

import "fmt"

func main() {
    var a int = 10          // 通用整数（随系统）
    var b uint8 = 255       // 无符号8位，最大值255（赋值256会编译错误）
    var c int64 = 9223372036854775807 // int64最大值
    fmt.Println("int:", a, "uint8:", b, "int64:", c) // 输出：int: 10 uint8: 255 int64: 9223372036854775807

    var f1 float32 = 3.1415926 // 32位浮点，精度有限
    f2 := 2.718281828459045    // 短变量声明，默认float64
    fmt.Println("float32:", f1, "float64:", f2) // 输出：float32: 3.1415925 float64: 2.718281828459045
    
    // 注意：浮点数精度问题
    fmt.Println("0.1 + 0.2 =", 0.1+0.2) // 输出：0.1 + 0.2 = 0.30000000000000004（非0.3）

    var c1 complex64 = 3 + 4i    // 32位复数（实部3，虚部4）
    c2 := 5 + 6i                 // 短变量声明，默认complex128
    fmt.Println("complex64:", c1)                // 输出：complex64: (3+4i)
    fmt.Println("实部:", real(c2), "虚部:", imag(c2)) // 输出：实部: 5 虚部: 6

    var b1 bool = true  // 显式声明
    b2 := false         // 短变量声明
    b3 := b1 && b2      // 逻辑与（都真才真）→ false
    b4 := b1 || b2      // 逻辑或（任一真则真）→ true
    b5 := !b1           // 逻辑非（取反）→ false
    
    fmt.Println("b1:", b1, "b2:", b2) // 输出：b1: true b2: false
    fmt.Println("b3 (&&):", b3, "b4 (||):", b4, "b5 (!):", b5) // 输出：b3 (&&): false b4 (||): true b5 (!): false
    
    // 条件判断（常用场景）
    if b1 {
        fmt.Println("b1 is true")
    } else {
        fmt.Println("b1 is false")
    }


    var s1 string = "Hello, Go!" // 双引号定义
	s2 := "Hello\nWorld"         // 支持转义（\n换行）
	s3 := `line1
	line2
	line3` // 反引号多行字符串（不转义）
	s4 := s1 + " " + s2 // 字符串拼接（+号）

	fmt.Println("s1:", s1) // 输出：s1: Hello, Go!
	fmt.Println("s2:", s2) // 输出：s2: Hello
	//      World
	fmt.Println("s3:", s3) // 输出：s3: line1
	//      line2
	//      line3
	fmt.Println("拼接后s4:", s4) // 输出：拼接后s4: Hello, Go! Hello
	//      World
	fmt.Println("s1长度（字节数）:", len(s1))      // 输出：10（每个ASCII字符占1字节）
	fmt.Println("\"Go语言\"长度:", len("Go语言")) // 输出：8（Go占2字节，中文"语""言"各占3字节）
}
----

=== 变量

Go 语言变量名由字母、数字、下划线组成，其中首个字符不能为数字。

声明变量的一般形式是使用 var 关键字：var param type，也可以一次声明多个变量：var param1，param2 type

[source, Go]
```
package main
import "fmt"
func main() {
    var a string = "hello"
    fmt.Println(a)

    var b, c int = 1, 2
    fmt.Println(b, c)
}
```

如果没有显示的为变量赋值，Go 编译器会为变量赋予这个类型的零值：
var a int // a的初值为int类型的零值：0

|===
|内置原生类型 |默认值（零值）

|所有整数类型 
|0

|浮点类型
|0.0

|布尔类型
|false

|字符串类型
|""

|指针、接口、切片、channel、map和函数类型
|nil
|===

变量声明块（block）的语法形式：

[source, Go]
```
var (
    a int = 128
    b int8 = 6
    s string = "hello"
    c rune = 'A'
    t bool = true
)

var (
    a, b, c int = 5, 6, 7
    c, d, e rune = 'C', 'D', 'E'
) 
```

两种变量声明语法糖：

1. 省略类型信息的声明：
* var a, b, c = 12, 'A', "hello"

2. 短变量声明：
[source, Go]
```
a := 12
b := 'A'
c := "hello"

a, b, c := 12, 'A', "hello"
```

=== 常量

常量中的数据类型只可以是布尔型、数字型（整数型、浮点型和复数）和字符串型。在程序运行时，不会被修改的量。其定义格式为：const identifier [type] = value。

[source, Go]
```
package main

import "fmt"

func main() {
   const LENGTH int = 20
   const WIDTH int = 15   
   var area int
   const a, b, c = 1, false, "str" 

   area = LENGTH * WIDTH
   fmt.Println("面积为 : ", area)
   
   fmt.Println(a, b, c)   
}
```








